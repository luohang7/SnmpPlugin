# Auto generated by LangBot Plugin SDK.
# Please refer to https://docs.langbot.app/en/plugin/dev/tutor.html for more details.
from __future__ import annotations

from langbot_plugin.api.definition.components.common.event_listener import EventListener
from langbot_plugin.api.entities import events, context
import logging

# è®¾ç½®æ—¥å¿—
logger = logging.getLogger(__name__)


class DefaultEventListener(EventListener):

    async def initialize(self):
        await super().initialize()

        # ç›‘å¬ç§èŠæ¶ˆæ¯
        @self.handler(events.PersonMessageReceived)
        async def handle_person_message(event_context: context.EventContext):
            """å¤„ç†ç§èŠæ¶ˆæ¯äº‹ä»¶"""
            print("="*50)
            print("ğŸ” æ”¶åˆ°ç§èŠæ¶ˆæ¯äº‹ä»¶:")
            print(f"äº‹ä»¶ç±»å‹: {type(event_context.event).__name__}")
            print(f"äº‹ä»¶å†…å®¹: {event_context.event}")
            print(f"å‘é€è€…ID: {event_context.event.sender_id}")
            print(f"æ¶ˆæ¯å†…å®¹: {event_context.event.message_chain}")
            print("="*50)

        # ç›‘å¬ç¾¤æ¶ˆæ¯
        @self.handler(events.GroupMessageReceived)
        async def handle_group_message(event_context: context.EventContext):
            """å¤„ç†ç¾¤æ¶ˆæ¯äº‹ä»¶"""
            print("="*50)
            print("ğŸ” æ”¶åˆ°ç¾¤æ¶ˆæ¯äº‹ä»¶:")
            print(f"äº‹ä»¶ç±»å‹: {type(event_context.event).__name__}")
            print(f"äº‹ä»¶å†…å®¹: {event_context.event}")
            print("="*50)

        logger.info("EventListener åˆå§‹åŒ–å®Œæˆï¼Œå¼€å§‹ç›‘å¬äº‹ä»¶...")